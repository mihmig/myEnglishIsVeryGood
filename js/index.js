var answers = {
    'm1vAtA' : {
        'm1vAtAq01': '6',
        'm1vAtAq02': '4',
        'm1vAtAq03': '2',
        'm1vAtAq04': '10',
        'm1vAtAq05': '8',
        'm1vAtAq06': '9',
        'm1vAtAq07': '7',
        'm1vAtAq08': '5'
    },
    'm1vAtB' : {
        'm1vAtBq01': '5',
        'm1vAtBq02': '1',
        'm1vAtBq03': '7',
        'm1vAtBq04': '4',
        'm1vAtBq05': '9',
        'm1vAtBq06': '6',
        'm1vAtBq07': '8'
    },
    'm1vAtC' : {
        'm1vAtCq01': '2',
        'm1vAtCq02': '2',
        'm1vAtCq03': '1',
        'm1vAtCq04': '2',
        'm1vAtCq05': '2',
        'm1vAtCq06': '2',
        'm1vAtCq07': '1',
        'm1vAtCq08': '2',
        'm1vAtCq09': '1',
        'm1vAtCq10': '1',
    },
    'm1vAtD': {
        'm1vAtDq01': 'rarely left',
        'm1vAtDq02': 'did you take',
        'm1vAtDq03': 'was watering',
        'm1vAtDq04': 'didnt meet',
        'm1vAtDq05': 'was listening'
    },
    'm1vAtF': {
        'm1vAtFq01': '5',
        'm1vAtFq02': '3',
        'm1vAtFq03': '2',
        'm1vAtFq04': '1',
        'm1vAtFq05': '4'
    },
    'm1vAtG': {
        'm1vAtGq01': '1',
        'm1vAtGq02': '2',
        'm1vAtGq03': '1',
        'm1vAtGq04': '1',
        'm1vAtGq05': '2'
    },
    'm1vAtH': {
        'm1vAtHq01': '3',
        'm1vAtHq02': '6',
        'm1vAtHq03': '1',
        'm1vAtHq04': '5',
        'm1vAtHq05': '4'
    },
    'm1vBtA' : {
        'm1vBtAq01': '2',
        'm1vBtAq02': '8',
        'm1vBtAq03': '3',
        'm1vBtAq04': '6',
        'm1vBtAq05': '4',
        'm1vBtAq06': '5',
        'm1vBtAq07': '9',
        'm1vBtAq08': '7'
    },
    'm1vBtB' : {
        'm1vBtBq01': '6',
        'm1vBtBq02': '7',
        'm1vBtBq03': '10',
        'm1vBtBq04': '4',
        'm1vBtBq05': '8',
        'm1vBtBq06': '2',
        'm1vBtBq07': '5'
    },
    'm1vBtC' : {
        'm1vBtCq01': '1',
        'm1vBtCq02': '1',
        'm1vBtCq03': '2',
        'm1vBtCq04': '1',
        'm1vBtCq05': '2',
        'm1vBtCq06': '2',
        'm1vBtCq07': '2',
        'm1vBtCq08': '1',
        'm1vBtCq09': '2',
        'm1vBtCq10': '2',
    },
    'm1vBtD': {
        'm1vBtDq01': 'didnt meet',
        'm1vBtDq02': 'were you doing',
        'm1vBtDq03': 'was listening',
        'm1vBtDq04': 'left',
        'm1vBtDq05': 'did you start'
    },
    'm1vBtE': {
        'm1vBtEq01': 'the most selfish',
        'm1vBtEq02': 'duller',
        'm1vBtEq03': 'the least',
        'm1vBtEq04': 'more',
        'm1vBtEq05': 'better'
    },
    'm1vBtF': {
        'm1vBtFq01': '4',
        'm1vBtFq02': '5',
        'm1vBtFq03': '1',
        'm1vBtFq04': '2',
        'm1vBtFq05': '3'
    },
    'm1vBtG': {
        'm1vBtGq01': '1',
        'm1vBtGq02': '2',
        'm1vBtGq03': '1',
        'm1vBtGq04': '2',
        'm1vBtGq05': '1'
    },
    'm1vBtH': {
        'm1vBtHq01': '6',
        'm1vBtHq02': '4',
        'm1vBtHq03': '5',
        'm1vBtHq04': '1',
        'm1vBtHq05': '3'
    },'m2vAtA' : {
        'm2vAtAq01': '2',
        'm2vAtAq02': '2',
        'm2vAtAq03': '1',
        'm2vAtAq04': '2',
        'm2vAtAq05': '1',
        'm2vAtAq06': '1',
        'm2vAtAq07': '2',
        'm2vAtAq08': '1',
        'm2vAtAq09': '2',
        'm2vAtAq10': '1'
    },
    'm2vAtB' : {
        'm2vAtBq01': '3',
        'm2vAtBq02': '5',
        'm2vAtBq03': '7',
        'm2vAtBq04': '4',
        'm2vAtBq05': '1'
    },
    'm2vAtC' : {
        'm2vAtCq01': 'havent bought',
        'm2vAtCq02': 'have you been writing',
        'm2vAtCq03': 'has gone',
        'm2vAtCq04': 'have you ever eaten',
        'm2vAtCq05': 'has been working',
    },
    'm2vAtD': {
        'm2vAtDq01': '1',
        'm2vAtDq02': '2',
        'm2vAtDq03': '2',
        'm2vAtDq04': '2',
        'm2vAtDq05': '1',
        'm2vAtDq06': '1',
        'm2vAtDq07': '1',
        'm2vAtDq08': '2',
        'm2vAtDq09': '1',
        'm2vAtDq10': '1'
    },
    'm2vAtE': {
        'm2vAtEq01': '2',
        'm2vAtEq02': '1',
        'm2vAtEq03': '5',
        'm2vAtEq04': '3',
        'm2vAtEq05': '4'
    },
    'm2vAtF': {
        'm2vAtFq01': '2',
        'm2vAtFq02': '3',
        'm2vAtFq03': '2',
        'm2vAtFq04': '1',
        'm2vAtFq05': '1',
        'm2vAtFq06': '2',
        'm2vAtFq07': '3',
        'm2vAtFq08': '3',
        'm2vAtFq09': '2',
        'm2vAtFq10': '1'
    },
    'm2vAtH': {
        'm2vAtHq01': '4',
        'm2vAtHq02': '2',
        'm2vAtHq03': '6',
        'm2vAtHq04': '1',
        'm2vAtHq05': '5'
    },
    'm2vBtA' : {
        'm2vBtAq01': '1',
        'm2vBtAq02': '1',
        'm2vBtAq03': '2',
        'm2vBtAq04': '2',
        'm2vBtAq05': '2',
        'm2vBtAq06': '1',
        'm2vBtAq07': '1',
        'm2vBtAq08': '2',
        'm2vBtAq09': '2',
        'm2vBtAq10': '2'
    },
    'm2vBtB' : {
        'm2vBtBq01': '3',
        'm2vBtBq02': '7',
        'm2vBtBq03': '1',
        'm2vBtBq04': '2',
        'm2vBtBq05': '6'
    },
    'm2vBtC' : {
        'm2vBtCq01': 'has been working',
        'm2vBtCq02': 'have you ever eaten',
        'm2vBtCq03': 'has gone',
        'm2vBtCq04': 'have you been cleaning',
        'm2vBtCq05': 'havent bought',
    },
    'm2vBtD': {
        'm2vAtDq01': '1',
        'm2vAtDq02': '1',
        'm2vAtDq03': '1',
        'm2vAtDq04': '2',
        'm2vAtDq05': '1',
        'm2vAtDq06': '2',
        'm2vAtDq07': '1',
        'm2vAtDq08': '2',
        'm2vAtDq09': '2',
        'm2vAtDq10': '1'
    },
    'm2vBtE': {
        'm2vAtEq01': '2',
        'm2vAtEq02': '1',
        'm2vAtEq03': '5',
        'm2vAtEq04': '3',
        'm2vAtEq05': '4'
    },
    'm2vBtF': {
        'm2vBtFq01': '2',
        'm2vBtFq02': '3',
        'm2vBtFq03': '2',
        'm2vBtFq04': '1',
        'm2vBtFq05': '1',
        'm2vBtFq06': '2',
        'm2vBtFq07': '3',
        'm2vBtFq08': '3',
        'm2vBtFq09': '2',
        'm2vBtFq10': '1'
    },
    'm2vBtH': {
        'm2vBtHq01': '4',
        'm2vBtHq02': '2',
        'm2vBtHq03': '6',
        'm2vBtHq04': '1',
        'm2vBtHq05': '5'
    },
    'm3vAtA' : {
        'm3vAtAq01': '2',
        'm3vAtAq02': '1',
        'm3vAtAq03': '1',
        'm3vAtAq04': '2',
        'm3vAtAq05': '1',
        'm3vAtAq06': '2',
        'm3vAtAq07': '2',
        'm3vAtAq08': '1'
    },
    'm3vAtB' : {
        'm3vAtBq01': '6',
        'm3vAtBq02': '9',
        'm3vAtBq03': '12',
        'm3vAtBq04': '2',
        'm3vAtBq05': '7',
        'm3vAtBq06': '5',
        'm3vAtBq07': '1',
        'm3vAtBq08': '8',
        'm3vAtBq09': '4'
    },
    'm3vAtC' : {
        'm3vAtCq01': 'had been studying',
        'm3vAtCq02': 'hadnt finished',
        'm3vAtCq03': 'had you been studying',
        'm3vAtCq04': 'had lived',
        'm3vAtCq05': 'had she finished',
    },
    'm3vAtD' : {
        'm3vAtDq01': 'went',
        'm3vAtDq02': 'had performed',
        'm3vAtDq03': 'had you been waiting',
        'm3vAtDq04': 'did James graduate',
        'm3vAtDq05': 'didnt win',
    },
    'm3vAtE': {
        'm3vAtEq01': '1',
        'm3vAtEq02': '2',
        'm3vAtEq03': '2',
        'm3vAtEq04': '2',
        'm3vAtEq05': '1',
        'm3vAtEq06': '2',
        'm3vAtEq07': '1',
        'm3vAtEq08': '2',
        'm3vAtEq09': '2'
    },
    'm3vAtF': {
        'm3vAtFq01': '3',
        'm3vAtFq02': '5',
        'm3vAtFq03': '4',
        'm3vAtFq04': '1',
        'm3vAtFq05': '2'
    }
    ,
    'm3vAtG': {
        'm3vAtGq01': '1',
        'm3vAtGq02': '2',
        'm3vAtGq03': '4',
        'm3vAtGq04': '2',
        'm3vAtGq05': '4'
    },
    'm3vAtH': {
        'm3vAtHq01': '3',
        'm3vAtHq02': '2',
        'm3vAtHq03': '1',
        'm3vAtHq04': '4',
        'm3vAtHq05': '5'
    },
    'm8vAtA': {
        'm8vAtAq01': '2',
        'm8vAtAq02': '2',
        'm8vAtAq03': '1',
        'm8vAtAq04': '2',
        'm8vAtAq05': '1',
    },
    'm8vAtB': {
        'm8vAtBq01': '4',
        'm8vAtBq02': '12',
        'm8vAtBq03': '9',
        'm8vAtBq04': '6',
        'm8vAtBq05': '10',
        'm8vAtBq06': '8',
        'm8vAtBq07': '3',
        'm8vAtBq08': '11',
        'm8vAtBq09': '1',
        'm8vAtBq10': '5'
    },
    'm8vAtC': {
        'm8vAtCq01': '2',
        'm8vAtCq02': '2',
        'm8vAtCq03': '1',
        'm8vAtCq04': '1'
    },
    'm8vAtD': {
        'm8vAtDq01': 'if',
        'm8vAtDq02': 'unless',
        'm8vAtDq03': 'unless',
        'm8vAtDq04': 'if',
        'm8vAtDq05': 'unless',
    },
    'm8vAtE': {
        'm8vAtEq01': 'wouldnt have told',
        'm8vAtEq02': 'would stop',
        'm8vAtEq03': 'becomes',
        'm8vAtEq04': 'will win',
        'm8vAtEq05': 'earned',
        'm8vAtEq06': 'boils',
        'm8vAtEq07': 'would have gone',
        'm8vAtEq08': 'wont come',
        'm8vAtEq09': 'would take',
        'm8vAtEq10': 'dont water',
    },
    'm8vAtF': {
        'm8vAtFq01': '3',
        'm8vAtFq02': '4',
        'm8vAtFq03': '2',
        'm8vAtFq04': '1',
        'm8vAtFq05': '5',
    },
    'm8vAtG': {
        'm8vAtGq01': 'A',
        'm8vAtGq02': 'B',
        'm8vAtGq03': 'C',
        'm8vAtGq04': 'C',
        'm8vAtGq05': 'D',
        'm8vAtGq06': 'C',
    },
    'm8vAtH': {
        'm8vAtHq01': '3',
        'm8vAtHq02': '1',
        'm8vAtHq03': '2',
        'm8vAtHq04': '6',
        'm8vAtHq05': '5',
    }
}
var currentTest = "";
function getAnswers(testId) {
    return answers[testId];
}

function init() {
    for (let testId in answers) {
        let status = getCookie(testId);
        let button = document.getElementById(testId+"button");
        if (!button) continue;
        if (status) {
            if (status == "pаssеd") {
                button.style.backgroundColor = "lightgreen";
            } else {
                button.style.backgroundColor = "lightpink";
            }
        }
    }
}
function selectCource(courceName) {
    location.href = courceName + ".html";
}
function goHome() {
    pauseAudio();
    hideAll();
    document.getElementById('homeScreen').style.display = 'block';

}
function hideAll() {
    var els = document.getElementsByClassName('screen');
    Array.prototype.forEach.call(els, function(el) {
        el.style.display = 'none';
    });
    document.getElementById('testBottomButtons').style.display = 'none';
}
function test(testId) {
    currentTest = testId;
    if (!answers[currentTest]) return;

    hideAll();
    if (document.getElementById(currentTest)) {
        document.getElementById(currentTest).style.display = 'block';

        var els = document.getElementsByTagName('select');
        Array.prototype.forEach.call(els, function (el) {
            el.style.backgroundColor = '';
        });
        document.getElementById('testBottomButtons').style.display = 'block';
    } else {
        loadAndStartTest(currentTest);
    }
}
function loadAndStartTest(testId) {
    fetch('tests/'+testId+'.html?'+ Math.random())
        .then(resp => resp.text())
        .then(text => {
            let testDiv = document.createElement('div');
            testDiv.innerHTML = text;
            // document.body.append(testDiv.firstChild);
            document.body.insertBefore(testDiv.firstChild, document.getElementById('testBottomButtons'));
            test(testId);
        });
}

function check() {
    pauseAudio();
    var correctAnswersCount = 0;
    var answers = getAnswers(currentTest);
    var questionsCount = 0;
    for (var key in answers) {
        questionsCount++;
        if (normalizeText(document.getElementById(key).value) === answers[key]) {
            correctAnswersCount++;
            document.getElementById(key).style.backgroundColor = 'lightgreen';
        } else {
            document.getElementById(key).style.backgroundColor = 'lightpink';
        }
    }


    if (correctAnswersCount === questionsCount) {
        document.getElementById("completedTestId").innerText = currentTest;
        document.getElementById("testPassedMessage").style.visibility="visible";
        document.getElementById(currentTest+"button").style.backgroundColor = "lightgreen";
        setCookie(currentTest, "pаssеd");
    } else {
        document.getElementById("failedTestResult").innerText = "Test " + currentTest + " failed. (" + correctAnswersCount + "/" + questionsCount + ")";
        document.getElementById("testFailedMessage").style.visibility="visible";
        document.getElementById(currentTest+"button").style.backgroundColor = "lightpink";
        setCookie(currentTest, "failed");
    }
}

function normalizeText(text) {
    return text.trim().toLowerCase().replace("'",'');
}

function hideMe(element) {
    if(element) {
        element.style.visibility = "hidden";
    }
}

function pauseAudio() {
    var audios = document.getElementsByTagName('audio');
    Array.prototype.forEach.call(audios, function (el) {
        el.pause();
    });
}